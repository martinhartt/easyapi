{"version":3,"sources":["webpack:///webpack/bootstrap f7ce6fd086deedc5febf","webpack:///./src/models/index.js","webpack:///external \"express\"","webpack:///./src/config/passport.js","webpack:///external \"jsonwebtoken\"","webpack:///./src/index.js","webpack:///./src/config/bootstrap.js","webpack:///./src/config/connections.js","webpack:///./src/middleware/authentication.js","webpack:///./src/models/attribute.js","webpack:///./src/models/device.js","webpack:///./src/models/endpoint.js","webpack:///./src/models/entry.js","webpack:///./src/models/issue.js","webpack:///./src/models/model.js","webpack:///./src/models/service.js","webpack:///./src/models/user.js","webpack:///./src/models/value.js","webpack:///./src/routes/attribute.js","webpack:///./src/routes/auth.js","webpack:///./src/routes/entry.js","webpack:///./src/routes/index.js","webpack:///./src/routes/model.js","webpack:///./src/routes/service.js","webpack:///./src/routes/value.js","webpack:///./src/services/natural.js","webpack:///./src/services/parse.js","webpack:///./src/services/service.js","webpack:///external \"bcrypt\"","webpack:///external \"body-parser\"","webpack:///external \"fs\"","webpack:///external \"nlp_compromise\"","webpack:///external \"passport\"","webpack:///external \"passport-local\"","webpack:///external \"path\"","webpack:///external \"request-promise\"","webpack:///external \"sbd\"","webpack:///external \"sequelize\"","webpack:///external \"validator\""],"names":["basename","path","__filename","env","process","NODE_ENV","db","config","connections","sequelize","use_env_variable","database","username","password","models","attribute","device","endpoint","entry","issue","model","service","user","value","capitalizeString","str","charAt","toUpperCase","slice","modelName","hasOwnProperty","console","log","Object","keys","forEach","associate","Sequelize","User","passport","use","usernameField","passwordField","session","passReqToCallback","req","email","done","findOne","where","then","foundUser","validPassword","message","create","passwordHash","generateHash","payload","id","token","jwt","sign","catch","err","serializeUser","deserializeUser","find","bootstrap","app","Express","port","sync","bodyParser","json","initialize","res","next","Error","status","locals","error","get","render","listen","Promise","resolve","development","host","dialect","test","production","originalUrl","startsWith","headers","authorization","end","split","verify","decoded","userId","findById","DataTypes","Attribute","define","name","STRING","type","classMethods","belongsTo","Model","onDelete","foreignKey","allowNull","Device","isPublic","BOOLEAN","Endpoint","instructions","mode","Service","Entry","index","INTEGER","hasMany","Value","Issue","unique","bcrypt","hashSync","genSaltSync","instanceMethods","compare","router","Router","post","modelId","param","ModelId","response","success","e","patch","attributeId","toUpdate","update","attributes","findAll","include","all","validate","form","errors","validator","isEmail","length","validation","authenticate","assign","newestEntry","order","entries","send","users","serviceId","ServiceId","newName","text","parseNaturalLanguage","result","parseSpreadsheet","modelDefinitions","createService","services","UserId","entryId","newValue","foundValue","findOrCreate","EntryId","AttributeId","parseResult","parse","modelStructure","allEntities","sentenceResult","data","potentialRelationships","parse_list","filter","word","POS_fine","tokens","cleanTree","filterTree","parse_tree","m","treeIndex","cleanTreeIndex","obj","relationship","inTree","nounTree","compareDepth","a","b","depth","subject","o","arc","includes","sort","object","properties","fullObject","getConjuctions","map","assignNounPhrase","entities","fullSubject","propertiesWithTypes","property","push","categoriseProp","entity","existingEntity","s","lemma","concat","buildPhrase","capitalizeWord","w","raw","postprocess","generateModelStructure","request","seperateSentences","join","JSON","condition","modifiers","child","found","decide","values","sum","Number","findIfPropertyIsRequired","prop","context","optionalKeywords","requiredKeywords","allRequiredInformation","monads","monad","k","findIfPropertyHasMultiple","determiners","adjModifiers","numModifiers","combined","allCardinalityInfo","modifier","singleKeywords","multipleKeywords","compromise","number","isContainment","containmentWords","tree","transform","space","othersInPhrase","start","propertyName","multiple","correctedNoun","noun","pluralize","singularize","presentVerb","verb","to_present","propertyType","possibleTypes","dateKeywords","numberKeywords","required","followModifiers","deeperConjuctions","flatMap","array","lambda","Array","prototype","apply","flatten","stringify","undefined","p","preps","prepPhrases","tags","more","Natural","_find","_findAll","_findIfPropertyIsRequired","_findIfPropertyHasMultiple","_filterTree","spreadsheets","allModelDefinitions","csv","modelDefinition","headingLine","rowLines","headings","rows","r","i","types","Set","row","determineType","reduce","prev","information","findType","string","safeJSONParse","isArray","example","toJSON","modelJSON","attributeByName","attributeDefinition","entriesDefinition","entryJSON","attributeString"],"mappings":"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","file":"index.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 38);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap f7ce6fd086deedc5febf","import fs from 'fs';\nimport path from 'path';\nimport Sequelize from 'sequelize';\nimport connections from '../config/connections';\n\nconst basename = path.basename(__filename);\nconst env = process.env.NODE_ENV || 'development';\nconst db = {};\n\nconst config = connections[env];\n\nlet sequelize;\nif (config.use_env_variable) {\n  sequelize = new Sequelize(process.env[config.use_env_variable]);\n} else {\n  sequelize = new Sequelize(config.database, config.username, config.password, config);\n}\n\nimport attribute from './attribute';\nimport device from './device';\nimport endpoint from './endpoint';\nimport entry from './entry';\nimport issue from './issue';\nimport model from './model';\nimport service from './service';\nimport user from './user';\nimport value from './value';\n\nlet models = {\n  attribute,\n  device,\n  endpoint,\n  entry,\n  issue,\n  model,\n  service,\n  user,\n  value,\n}\n\nconst capitalizeString = (str) => str.charAt(0).toUpperCase() + str.slice(1);\n\nfor (const modelName in models) {\n  if (!models.hasOwnProperty(modelName)) continue;\n\n  db[capitalizeString(modelName)] = models[modelName](sequelize, Sequelize);\n}\n\nconsole.log(db);\n\nObject.keys(db).forEach((modelName) => {\n  if (db[modelName].associate) {\n    db[modelName].associate(db);\n  }\n});\n\ndb.sequelize = sequelize;\ndb.Sequelize = Sequelize;\n\nexport default db;\n\n\n\n// WEBPACK FOOTER //\n// ./src/models/index.js","module.exports = require(\"express\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express\"\n// module id = 1\n// module chunks = 0","import passport from 'passport';\nimport { Strategy as LocalStrategy } from 'passport-local';\nimport models from '../models';\nimport jwt from 'jsonwebtoken';\n\nconst { User } = models;\n\npassport.use(new LocalStrategy({\n  usernameField: 'email',\n  passwordField: 'password',\n  session: false,\n  passReqToCallback: true\n}, (req, email, password, done) => {\n    return User.findOne({\n      where: {\n        email,\n      }\n    })\n    .then(async foundUser => {\n      let user;\n      if (foundUser) {\n        // User exists\n        if (!(await foundUser.validPassword(password))) {\n          console.log('Invalid password')\n          return done(null, false, {\n            message: 'Incorrect password.',\n          });\n        }\n        user = foundUser;\n\n      } else {\n        // New user\n        user = await User.create({\n          email,\n          passwordHash: User.generateHash(password),\n        });\n      }\n\n      const payload = {\n        user: user.id,\n      }\n\n      const token = jwt.sign(payload, 'secret');\n\n      return done(null, {\n        user: {\n          email: user.email,\n        },\n        token,\n      });\n    })\n    .catch(err => {\n      return done(err);\n    });\n  }\n));\n\npassport.serializeUser(function(user, done) {\n  done(null, user.id);\n});\n\npassport.deserializeUser(function(id, done) {\n  User.find({\n    where: { id },\n  }, function(err, [user]) {\n    done(err, user);\n  });\n});\n\nexport default passport;\n\n\n\n// WEBPACK FOOTER //\n// ./src/config/passport.js","module.exports = require(\"jsonwebtoken\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"jsonwebtoken\"\n// module id = 3\n// module chunks = 0","import Express from 'express';\nimport bodyParser from 'body-parser';\nimport passport from './config/passport';\nimport index from './routes/index';\nimport auth from './routes/auth';\nimport service from './routes/service';\nimport model from './routes/model';\nimport entry from './routes/entry';\nimport attribute from './routes/attribute';\nimport value from './routes/value';\nimport bootstrap from './config/bootstrap';\nimport models from './models';\nimport authentication from './middleware/authentication';\n\n\nbootstrap().then(async () => {\n  /* eslint-disable new-cap */\n  const app = Express();\n  const port = 9001;\n\n  await models.sequelize.sync();\n\n  app.use(bodyParser.json());\n\n  app.use(passport.initialize());\n  app.use(authentication);\n\n  app.use('/api', index);\n  app.use('/api/service', service);\n  app.use('/api/auth', auth);\n  app.use('/api/model', model);\n  app.use('/api/attribute', attribute);\n  app.use('/api/entry', entry);\n  app.use('/api/value', value);\n\n  // catch 404 and forward to error handler\n  app.use((req, res, next) => {\n    const err = new Error('Not Found!');\n    err.status = 404;\n    next(err);\n  });\n\n  // error handler\n  app.use((err, req, res) => {\n    // set locals, only providing error in development\n    /* eslint-disable no-param-reassign */\n    res.locals.message = err.message;\n    res.locals.error = req.app.get('env') === 'development' ? err : {};\n\n    // render the error page\n    res.status(err.status || 500);\n    res.render('error');\n  });\n\n  app.listen(port);\n  console.log(`Server is running on port ${port}`);\n})\n.catch(err => console.error(err));\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","/**\n * Bootstrap: All scripts that should be executed before server starts running\n */\n\nexport default function bootstrap() {\n  return Promise.resolve();\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/config/bootstrap.js","const connections = {\n  development: {\n    username: 'martinkubat',\n    password: '',\n    database: 'martinkubat',\n    host: 'localhost',\n    dialect: 'postgres',\n  },\n  test: {\n    username: 'root',\n    password: null,\n    database: 'database_test',\n    host: '127.0.0.1',\n    dialect: 'mysql',\n  },\n  production: {\n    username: 'root',\n    password: null,\n    database: 'database_production',\n    host: '127.0.0.1',\n    dialect: 'mysql',\n  },\n};\n\nexport default connections;\n\n\n\n// WEBPACK FOOTER //\n// ./src/config/connections.js","import jwt from 'jsonwebtoken';\nimport models from '../models';\n\nconst { User } = models;\n\nexport default function(req, res, next) {\n  if (req.originalUrl.startsWith('/api/auth/')) {\n    return next();\n  }\n\n  if (!req.headers.authorization) {\n    return res.status(401).end();\n  }\n\n  const token = req.headers.authorization.split(' ')[1];\n  return jwt.verify(token, 'secret', (err, decoded) => {\n    if (err) return res.status(401).end();\n\n    const userId = decoded.user;\n\n    return User.findById(userId)\n      .then(user => {\n        if (user) {\n          req.user = user;\n          return next();\n        }\n        return res.status(401).end();\n      })\n      .catch(err => res.status(401).end());\n  });\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/middleware/authentication.js","export default function (sequelize, DataTypes) {\n  const Attribute = sequelize.define('Attribute', {\n    name: DataTypes.STRING,\n    type: DataTypes.STRING,\n  }, {\n    classMethods: {\n      associate(models) {\n        Attribute.belongsTo(models.Model, {\n          onDelete: 'CASCADE',\n          foreignKey: {\n            allowNull: false,\n          },\n        });\n      },\n    },\n  });\n\n  return Attribute;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/models/attribute.js","export default function (sequelize, DataTypes) {\n  const Device = sequelize.define('Device', {\n    name: DataTypes.STRING,\n    isPublic: DataTypes.BOOLEAN,\n  }, {\n    classMethods: {\n      associate(models) {\n        Device.belongsTo(models.User, {\n          onDelete: 'CASCADE',\n          foreignKey: {\n            allowNull: false,\n          },\n        });\n      },\n    },\n  });\n\n  return Device;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/models/device.js","export default function (sequelize, DataTypes) {\n  const Endpoint = sequelize.define('Endpoint', {\n    instructions: DataTypes.STRING,\n    mode: DataTypes.STRING,\n    path: DataTypes.STRING,\n  }, {\n    classMethods: {\n      associate(models) {\n        Endpoint.belongsTo(models.Service, {\n          onDelete: 'CASCADE',\n          foreignKey: {\n            allowNull: false,\n          },\n        });\n      },\n    },\n  });\n\n  return Endpoint;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/models/endpoint.js","export default function (sequelize, DataTypes) {\n  const Entry = sequelize.define('Entry', {\n    index: DataTypes.INTEGER,\n  }, {\n    classMethods: {\n      associate(models) {\n        Entry.belongsTo(models.Model, {\n          onDelete: 'CASCADE',\n          foreignKey: {\n            allowNull: false,\n          },\n        });\n        Entry.hasMany(models.Value);\n      },\n    },\n  });\n\n  return Entry;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/models/entry.js","export default function (sequelize, DataTypes) {\n  const Issue = sequelize.define('Issue', {\n    name: DataTypes.STRING,\n    isPublic: DataTypes.BOOLEAN,\n  }, {\n    classMethods: {\n      associate(models) {\n        Issue.belongsTo(models.User, {\n          onDelete: 'CASCADE',\n          foreignKey: {\n            allowNull: false,\n          },\n        });\n      },\n    },\n  });\n\n  return Issue;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/models/issue.js","export default function (sequelize, DataTypes) {\n  const Model = sequelize.define('Model', {\n    name: DataTypes.STRING,\n  }, {\n    classMethods: {\n      associate(models) {\n        Model.belongsTo(models.Service, {\n          onDelete: 'CASCADE',\n          foreignKey: {\n            allowNull: false,\n          },\n        });\n        Model.hasMany(models.Attribute);\n        Model.hasMany(models.Entry);\n      },\n    },\n  });\n\n  return Model;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/models/model.js","export default function (sequelize, DataTypes) {\n  const Service = sequelize.define('Service', {\n    name: DataTypes.STRING,\n    isPublic: DataTypes.BOOLEAN,\n  }, {\n    classMethods: {\n      associate(models) {\n        Service.belongsTo(models.User, {\n          onDelete: 'CASCADE',\n          foreignKey: {\n            allowNull: false,\n          },\n        });\n        Service.hasMany(models.Endpoint);\n        Service.hasMany(models.Model);\n      },\n    },\n  });\n\n  return Service;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/models/service.js","import bcrypt from 'bcrypt';\n\nexport default function (sequelize, DataTypes) {\n  const User = sequelize.define('User', {\n    email: {\n      type: DataTypes.STRING,\n      unique: true,\n    },\n    passwordHash: DataTypes.STRING,\n  }, {\n    classMethods: {\n      associate(models) {\n        User.hasMany(models.Service);\n      },\n      generateHash: password => bcrypt.hashSync(password, bcrypt.genSaltSync(8), null),\n    },\n    instanceMethods: {\n      generateHash: password => bcrypt.hashSync(password, bcrypt.genSaltSync(8), null),\n      validPassword: function(password) {\n        console.log(password,this.passwordHash);\n        return bcrypt.compare(password, this.passwordHash);\n      },\n    }\n  });\n\n  return User;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/models/user.js","export default function (sequelize, DataTypes) {\n  const Value = sequelize.define('Value', {\n    value: DataTypes.STRING,\n  }, {\n    classMethods: {\n      associate(models) {\n        Value.belongsTo(models.Entry, {\n          onDelete: 'CASCADE',\n          foreignKey: {\n            allowNull: false,\n          },\n        });\n        Value.belongsTo(models.Attribute);\n      },\n    },\n  });\n\n  return Value;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/models/value.js","import { Router } from 'express';\nimport databaseModels from '../models';\n\nconst { Service, Model, Attribute, Entry, Value } = databaseModels;\n\n/* eslint-disable new-cap */\nconst router = Router();\n\n/* POST scratch. */\nrouter.post('/', async (req, res) => {\n  const modelId = req.param('model');\n  const name = req.param('name');\n  const type = req.param('type');\n\n  try {\n    const attribute = await Attribute.create({\n      name,\n      type,\n      ModelId: modelId,\n    });\n\n    const response = {\n      attribute,\n      success: true,\n    };\n    return res.json(response);\n  } catch (e) {\n    return res.status(501).json({\n      error: e,\n      success: false,\n    });\n  }\n});\n\nrouter.patch('/:id', async (req, res) => {\n  const attributeId = req.param('id');\n\n  const toUpdate = {};\n\n  if (req.param('name')) {\n    toUpdate.name = req.param('name');\n  }\n  if (req.param('type')) {\n    toUpdate.type = req.param('type');\n  }\n\n  try {\n    const attribute = await Attribute.update(\n      toUpdate,\n      { where: { id: attributeId } },\n    );\n\n    return res.json({\n      attribute,\n      success: true,\n    });\n  } catch (e) {\n    return res.status(501).json({\n      error: e,\n      success: false,\n    });\n  }\n});\n\nrouter.get('/', async (req, res) => {\n  try {\n    const modelId = req.param('model');\n    const attributes = await Attribute.findAll({\n      where: {\n        ModelId: modelId,\n      },\n      include: [{ all: true }],\n    });\n    return res.json({\n      attributes,\n      success: true,\n    });\n  } catch (e) {\n    return res.status(501).json({\n      error: e,\n      success: false,\n    });\n  }\n});\n\nexport default router;\n\n\n\n// WEBPACK FOOTER //\n// ./src/routes/attribute.js","import { Router } from 'express';\nimport passport from '../config/passport';\nimport validator from 'validator';\n\n/* eslint-disable new-cap */\nconst router = Router();\n\nfunction validate(form) {\n  const errors = {};\n  let success = true;\n\n  if (!form || !form.email || !validator.isEmail(form.email)) {\n    success = false;\n    errors.email = 'This is not a valid email.'\n  }\n\n  if (!form || !form.password || form.password.length < 5) {\n    success = false\n    errors.password = 'This password is too short.';\n  }\n\n  return {\n    success,\n    errors,\n  }\n}\n\n/* GET index. */\nrouter.post('/login', (req, res, next) => {\n  const validation = validate({\n    email: req.param('email'),\n    password: req.param('password'),\n  });\n\n  if (!validation.success) {\n    return res.status(400).json({\n      success: false,\n      errors: validation.errors,\n    })\n  }\n\n  return passport.authenticate('local', (err, user) => {\n    console.log(err, user);\n    if (err || !user) {\n      return res.status(400).json({\n        success: false,\n        message: 'Incorrect details',\n      });\n    }\n\n    return res.status(200).json(Object.assign({\n      success: true,\n      errors: {},\n    }, user));\n  })(req, res, next);\n\n});\n\n\nexport default router;\n\n\n\n// WEBPACK FOOTER //\n// ./src/routes/auth.js","import { Router } from 'express';\nimport databaseModels from '../models';\n\nconst { Service, Model, Attribute, Entry, Value } = databaseModels;\n\n/* eslint-disable new-cap */\nconst router = Router();\n\n/* POST scratch. */\nrouter.post('/', async (req, res) => {\n  const modelId = req.param('model');\n\n  try {\n    const newestEntry = await Entry.findOne({\n      where: {\n        ModelId: modelId,\n      },\n      order: 'index DESC',\n    });\n    const index = newestEntry.index + 1;\n\n    const entry = await Entry.create({\n      index,\n      ModelId: modelId,\n    });\n\n    const response = {\n      entry,\n      success: true,\n    };\n    return res.json(response);\n  } catch (e) {\n    return res.status(501).json({\n      error: e,\n      success: false,\n    });\n  }\n});\n\nrouter.get('/', async (req, res) => {\n  try {\n    const modelId = req.param('model');\n    const entries = await Entry.findAll({\n      where: {\n        ModelId: modelId,\n      },\n      include: [{ all: true }],\n    });\n    return res.json({\n      entries,\n      success: true,\n    });\n  } catch (e) {\n    return res.status(501).json({\n      error: e,\n      success: false,\n    });\n  }\n});\n\nexport default router;\n\n\n\n// WEBPACK FOOTER //\n// ./src/routes/entry.js","import { Router } from 'express';\nimport { User, Service } from '../models';\n\n/* eslint-disable new-cap */\nconst router = Router();\n\n/* GET index. */\nrouter.get('/', (req, res) => {\n  res.send('Hello ok yep!');\n});\n\nrouter.get('/models', (req, res) => {\n  User.findAll({\n    include: [Service],\n  }).then((users) => {\n    res.send(users);\n  });\n});\n\nexport default router;\n\n\n\n// WEBPACK FOOTER //\n// ./src/routes/index.js","import { Router } from 'express';\nimport databaseModels from '../models';\n\nconst { Service, Model, Attribute, Entry, Value } = databaseModels;\n\n/* eslint-disable new-cap */\nconst router = Router();\n\n/* POST scratch. */\nrouter.post('/', async (req, res) => {\n  const serviceId = req.param('service');\n  const name = req.param('name');\n\n  try {\n    const model = await Model.create({\n      name,\n      ServiceId: serviceId,\n    });\n\n    const response = {\n      model,\n      success: true,\n    };\n    return res.json(response);\n  } catch (e) {\n    return res.status(501).json({\n      error: e,\n      success: false,\n    });\n  }\n});\n\nrouter.patch('/:id', async (req, res) => {\n  const newName = req.param('name');\n  const modelId = req.param('id');\n\n  try {\n    const model = await Model.update(\n      { name: newName },\n      { where: { id: modelId } },\n    );\n\n    return res.json({\n      model,\n      success: true,\n    });\n  } catch (e) {\n    return res.status(501).json({\n      error: e,\n      success: false,\n    });\n  }\n});\n\nrouter.get('/', async (req, res) => {\n  try {\n    const serviceId = req.param('service');\n    const model = await Model.findAll({\n      where: {\n        ServiceId: serviceId,\n      },\n      include: [{ all: true }],\n    });\n    return res.json({\n      model,\n      success: true,\n    });\n  } catch (e) {\n    return res.status(501).json({\n      error: e,\n      success: false,\n    });\n  }\n});\n\n\nexport default router;\n\n\n\n// WEBPACK FOOTER //\n// ./src/routes/model.js","import { Router } from 'express';\nimport { parseSpreadsheet, parseNaturalLanguage } from '../services/parse';\nimport { createService, findServices } from '../services/service';\nimport databaseModels from '../models';\n\nconst { Service, Model, Attribute, Entry, Value } = databaseModels;\n\n\n/* eslint-disable new-cap */\nconst router = Router();\n\nrouter.post('/parseText', (req, res) => {\n  const text = req.param('text');\n  return parseNaturalLanguage(text)\n  .then(result => res.send(result));\n});\n\nrouter.post('/parseSpreadsheet', (req, res) => {\n  const text = req.param('text');\n  return parseSpreadsheet(text)\n  .then(result => res.send(result));\n});\n\n/* POST scratch. */\nrouter.post('/', async (req, res) => {\n  const name = req.param('name');\n  const modelDefinitions = req.param('models');\n\n  // TODO Validation\n\n  try {\n    const service = await createService(\n      name,\n      modelDefinitions,\n      req.user.id,\n    );\n\n    const response = {\n      service,\n      success: true,\n    };\n    return res.json(response);\n  } catch (e) {\n    console.error(e);\n    return res.status(501).json({\n      error: e,\n      success: false,\n    });\n  }\n});\n\nrouter.get('/', async (req, res) => {\n  try {\n    const services = await Service.findAll({\n      where: {\n        UserId: req.user.id,\n      },\n    });\n    return res.json({\n      services,\n      success: true,\n    });\n  } catch (e) {\n    return res.status(501).json({\n      error: e,\n      success: false,\n    });\n  }\n});\n\n\nrouter.get('/:id', async (req, res) => {\n  try {\n    const serviceId = req.param('id');\n    const service = await Service.findOne({\n      where: {\n        id: serviceId,\n      },\n      include: [{ all: true }],\n    });\n    return res.json({\n      service,\n      success: true,\n    });\n  } catch (e) {\n    return res.status(501).json({\n      error: e,\n      success: false,\n    });\n  }\n});\n\nrouter.patch('/:id', async (req, res) => {\n  try {\n    const serviceId = req.param('id');\n    const toUpdate = {};\n\n    if (req.param('name')) {\n      toUpdate.name = req.param('name');\n    }\n    if (req.param('isPublic')) {\n      toUpdate.isPublic = req.param('isPublic');\n    }\n\n    const service = await Service.update(\n      toUpdate,\n      { where: { id: serviceId } },\n    );\n    return res.json({\n      service,\n      success: true,\n    });\n  } catch (e) {\n    return res.status(501).json({\n      error: e,\n      success: false,\n    });\n  }\n});\n\n\nexport default router;\n\n\n\n// WEBPACK FOOTER //\n// ./src/routes/service.js","import { Router } from 'express';\nimport databaseModels from '../models';\n\nconst { Service, Model, Attribute, Entry, Value } = databaseModels;\n\n/* eslint-disable new-cap */\nconst router = Router();\n\nrouter.patch('/', async (req, res) => {\n  const entryId = req.param('entry');\n  const attributeId = req.param('attribute');\n  const newValue = req.param('value');\n\n  try {\n    const [foundValue] = await Value.findOrCreate({\n      where: {\n        EntryId: entryId,\n        AttributeId: attributeId,\n      },\n    });\n\n    const [value] = await Value.update(\n      { value: newValue },\n      { where: { id: foundValue.id } },\n    );\n\n    const response = {\n      value,\n      success: true,\n    };\n    return res.json(response);\n  } catch (e) {\n    return res.status(501).json({\n      error: e,\n      success: false,\n    });\n  }\n});\n\nrouter.patch('/:id', async (req, res) => {\n  const attributeId = req.param('id');\n\n  const toUpdate = {};\n\n  if (req.param('name')) {\n    toUpdate.name = req.param('name');\n  }\n  if (req.param('type')) {\n    toUpdate.type = req.param('type');\n  }\n\n  try {\n    const attribute = await Attribute.update(\n      toUpdate,\n      { where: { id: attributeId } },\n    );\n\n    return res.json({\n      attribute,\n      success: true,\n    });\n  } catch (e) {\n    return res.status(501).json({\n      error: e,\n      success: false,\n    });\n  }\n});\n\nrouter.get('/', async (req, res) => {\n  try {\n    const modelId = req.param('model');\n    const attributes = await Attribute.findAll({\n      where: {\n        ModelId: modelId,\n      },\n      include: [{ all: true }],\n    });\n    return res.json({\n      attributes,\n      success: true,\n    });\n  } catch (e) {\n    return res.status(501).json({\n      error: e,\n      success: false,\n    });\n  }\n});\n\nexport default router;\n\n\n\n// WEBPACK FOOTER //\n// ./src/routes/value.js","import request from 'request-promise';\nimport compromise from 'nlp_compromise';\n\n/**\n * Natural Service: A service for extracting information from natural speech.\n */\nimport { sentences as seperateSentences } from 'sbd';\n\n// Uses spacy to deconstruct text into a dependancy parse tree\nfunction parse(text) {\n\n  return request.post('http://localhost:5000/parse', {\n    form: {\n      text: seperateSentences(text).join('<#SENT_SEPERATOR#>'),\n    },\n  })\n  .then(res => JSON.parse(res));\n}\n\n// In the dependency parse tree it finds first object which satisfies the condition\nfunction find(object, condition) {\n  if (condition(object)) return object;\n\n  if (!object || !object.modifiers || object.modifiers.length === 0) return null;\n  for (const child of object.modifiers) {\n    const result = find(child, condition);\n    if (result) return result;\n  }\n  return null;\n}\n\n// In the dependency parse tree it finds all objects which satisfy the condition\nfunction findAll(object, condition) {\n  let found = [];\n  if (condition(object)) found.push(object);\n\n  if (!object || !object.modifiers || object.modifiers.length === 0) return found;\n\n  for (const child of object.modifiers) {\n    const result = findAll(child, condition);\n    if (result.length) found = [...result, ...found];\n  }\n  return found;\n}\n\n// From an array of booleans decide the final value\nfunction decide(values) {\n  if (values.length === 0) return null;\n\n  let sum = 0;\n  for (const value of values) {\n    sum += Number(value);\n  }\n  return sum / values.length >= 0.5;\n}\n\n// Finds the existance of property. Returns string of 'required', 'optional', 'unknown'\nfunction findIfPropertyIsRequired(prop, context) {\n  //  https://en.wikipedia.org/wiki/Auxiliary_verb\n  const optionalKeywords = ['may', 'might', 'could', 'should', 'maybe', 'possible', 'possibly', 'optionally', 'optional', 'ought'];\n  const requiredKeywords = ['must', 'needs', 'need', 'shall', 'will'];\n\n  const allRequiredInformation = [];\n\n  // Find if the relationship has monads attached\n  if (!context.modifiers || !context.modifiers.length) return false;\n  const monads = context.modifiers.filter(o => o.arc === 'aux');\n\n  for (const monad of monads) {\n    if (optionalKeywords.find(k => k === monad.lemma)) {\n      allRequiredInformation.push(false);\n    } else if (requiredKeywords.find(k => k === monad.lemma)) {\n      allRequiredInformation.push(true);\n    }\n  }\n\n  return decide(allRequiredInformation) || false;\n}\n\n// Finds if a property has multiple instances\nfunction findIfPropertyHasMultiple(prop) {\n  const determiners = prop.modifiers ? prop.modifiers.filter(o => o.arc === 'det') : [];\n  const adjModifiers = prop.modifiers ? prop.modifiers.filter(o => o.arc === 'amod') : [];\n  const numModifiers = prop.modifiers ? prop.modifiers.filter(o => o.arc === 'nummod') : [];\n\n  const combined = determiners.concat(adjModifiers).concat(numModifiers);\n  // console.log(prop.lemma, ' findupper ', combined);\n\n  // If the noun is plural then it will be multiple\n  if (prop.POS_fine === 'NNS') {\n    return true;\n  }\n\n  if (combined.length === 0) return false;\n\n  // Find all information related to upper bound\n  const allCardinalityInfo = [];\n  for (const modifier of combined) {\n    const singleKeywords = ['a', 'single', 'one'];\n    const multipleKeywords = ['many', 'multiple', 'several'];\n    // const singleNumbers = ['one', 'zero'];\n\n    if (modifier.arc === 'nummod') {\n      // Parse value of number\n      allCardinalityInfo.push(compromise.value(modifier.lemma).number > 1)\n    }\n\n    if (singleKeywords.find(k => k === modifier.lemma)) {\n      allCardinalityInfo.push(false);\n    } else if (multipleKeywords.find(k => k === modifier.lemma)) {\n      allCardinalityInfo.push(true);\n    }\n  }\n\n  return decide(allCardinalityInfo) || false;\n}\n\nfunction isContainment(relationship) {\n  const containmentWords = [\n    'have',\n    'include',\n    'incorporate',\n    'consist',\n    'comprise',\n    'contain',\n  ];\n\n  return containmentWords.find(w => w == relationship.lemma);\n}\n\nfunction buildPhrase(tree, transform = w => w, space = '_') {\n  const othersInPhrase = tree.othersInPhrase;\n\n  if (othersInPhrase.length) {\n    return [tree, ...othersInPhrase].sort((a,b) => a.start - b.start).map(o => o.word).map(transform).join(space);\n  } else {\n    return tree.word;\n  }\n}\n\nfunction propertyName(prop, relationship, multiple) {\n  let entity = '';\n\n  const correctedNoun = multiple ?\n    compromise.noun(prop.lemma).pluralize() :\n    compromise.noun(prop.lemma).singularize();\n\n\n  const othersInPhrase = prop.othersInPhrase;\n\n  entity = buildPhrase(prop);\n\n  if (isContainment(relationship)) {\n    return entity;\n  }\n\n  const presentVerb = compromise.verb(relationship.word).to_present();\n\n  return `${presentVerb}_${entity}`;\n}\n\nconst capitalizeWord = str => str.charAt(0).toUpperCase() + str.slice(1);\n\nfunction propertyType(prop, entities = []) {\n  for (const entity of entities) {\n    if (entity.raw === prop.raw ||\n        entity.lemma === prop.lemma) {\n      return capitalizeWord(entity.lemma);\n    }\n  }\n\n\n\n  const possibleTypes = [];\n\n  // Check criteria for date.\n  const dateKeywords = [\n    'date',\n    'day', // TODO Add more keywords\n  ]\n\n  // Check criteria for number.\n  const numberKeywords = [\n    'number',\n    'integer',\n    'float',\n    'double',\n    ''\n  ]\n\n  // Check for integer or float\n\n  return 'string';\n}\n\nfunction categoriseProp(prop, context, relationship, entities) {\n  const multiple = findIfPropertyHasMultiple(prop);\n\n  const type = propertyType(prop, entities);\n  const name = propertyName(prop, relationship, multiple);\n  const required = findIfPropertyIsRequired(prop, context);\n\n  return {\n    type,\n    name,\n    raw: prop.word,\n    lemma: prop.lemma,\n    required,\n    multiple,\n  };\n}\n\nfunction getConjuctions(object) {\n  return followModifiers(object, o => o.arc === 'conj');\n}\n\nfunction followModifiers(tree, condition) {\n  if (!tree || !tree.modifiers || tree.modifiers.length === 0) return [];\n\n  const [modifier] = tree.modifiers.filter(condition);\n  const deeperConjuctions = followModifiers(modifier, condition);\n\n  if (deeperConjuctions.length) {\n    return [\n      modifier,\n      ...deeperConjuctions,\n    ];\n  }\n  if (modifier) {\n    return [modifier];\n  }\n  return [];\n}\n\nfunction postprocess(modelStructure, entities) {\n  for (const models of modelStructure) {\n    for (const prop of models.properties) {\n      prop.type = propertyType(prop, entities);\n    }\n  }\n}\n\nfunction flatMap(array, lambda) {\n  if (!array) return [];\n  return Array.prototype.concat.apply([], array.map(lambda));\n};\n\nfunction flatten(array) {\n  if (!array) return [];\n  return Array.prototype.concat.apply([], array);\n};\n\nfunction filterTree(tree, condition, depth = 0) {\n  if (!tree) return;\n  if (depth === 0) tree = JSON.parse(JSON.stringify(tree)); // Clone the tree\n\n  let modifiers = flatMap(\n    tree.modifiers,\n    m => filterTree(m, e => condition(e, depth, tree), depth+1)\n  );\n\n  if (condition(tree)) {\n    if (modifiers.length < 1) {\n      // delete tree.modifiers;\n      return Object.assign(tree, {\n        modifiers: undefined,\n      });\n    }\n    return Object.assign(tree, {\n      modifiers,\n    });\n  } else {\n    return modifiers;\n  }\n}\n\nfunction assignNounPhrase(p) {\n  const preps = findAll(p, o => o.arc === 'prep');\n  const prepPhrases = preps.map(\n    o => [o, ...(o.modifiers.filter(m => m.arc === 'pobj'))]\n  );\n\n  const tags = ['compound', 'amod'];\n  const more = findAll(p, m => tags.includes(m.arc));\n\n  p.othersInPhrase = [...flatten(prepPhrases), ...more].sort((a, b) => a.start - b.start);\n\n  return p;\n}\n\nasync function generateModelStructure(text) {\n  // Annotate raw text with POS and get dependency structure\n  const parseResult = await parse(text);\n  const modelStructure = [];\n  let allEntities = [];\n\n  // Useful transformations\n  // Remove oxford comma!\n\n  for (const sentenceResult of parseResult.data) {\n    // Find potential entities\n    // const potentialEntities = sentenceResult.parse_list\n      // .filter(word => word.POS_coarse === 'NOUN');\n\n    // Find relationships\n    const potentialRelationships = sentenceResult.parse_list\n      .filter(word => word.POS_fine.startsWith('V'));\n\n    // Build up tree of words to their place in parse tree\n    const tokens = sentenceResult.parse_list;\n    const cleanTree = filterTree(sentenceResult.parse_tree[0], m => m.POS_fine.startsWith('V') || m.POS_fine.startsWith('N') || m.POS_fine === 'PRP');\n\n    const treeIndex = {};\n    const cleanTreeIndex = {};\n    tokens.forEach((token) => {\n      treeIndex[token.id] = find(sentenceResult.parse_tree[0], obj => obj.id === token.id);\n      cleanTreeIndex[token.id] = find(cleanTree, obj => obj.id === token.id);\n    });\n\n\n    // console.log(cleanTree, cleanTreeIndex)\n\n    for (const relationship of potentialRelationships) {\n      // First containment\n      let inTree = cleanTreeIndex[relationship.id];\n\n      let nounTree = filterTree(inTree, m => m.POS_fine.startsWith('N') || m.POS_fine === 'PRP')\n      const compareDepth = (a, b) => a.depth - b.depth;\n\n      if (!nounTree || nounTree.length < 1) continue;\n      // Find subject and object\n      // console.log('\\n\\n\\nOK ',inTree, nounTree);\n      const [subject] = nounTree.filter(o => o.arc.includes('subj')).sort(compareDepth);\n      const [object] = nounTree.filter(o => o.arc.includes('obj')).sort(compareDepth);\n\n      let properties = [];\n      if (object) {\n        // This is the properties\n        const fullObject = treeIndex[object.id];\n        properties = [fullObject, ...getConjuctions(fullObject)];\n\n        properties = properties.map(assignNounPhrase);\n      }\n      let entities = [];\n      if (subject) {\n        // This is entities\n        const fullSubject = treeIndex[subject.id];\n        entities = [fullSubject, ...getConjuctions(fullSubject)];\n        allEntities = [...allEntities, ...entities];\n        allEntities = allEntities.map(assignNounPhrase);\n      }\n\n\n      inTree = treeIndex[relationship.id];\n\n      const propertiesWithTypes = [];\n      for (const property of properties) {\n        propertiesWithTypes.push(categoriseProp(property, inTree, relationship, entities));\n      }\n\n      for (const entity of entities) {\n        const existingEntity = modelStructure.find(s => s.name === entity.lemma);\n\n        if (existingEntity) {\n          existingEntity.properties = existingEntity.properties.concat(propertiesWithTypes);\n        } else {\n          modelStructure.push({\n            name: buildPhrase(entity, w => capitalizeWord(w), ' '),\n            raw: entity.word,\n            properties: propertiesWithTypes,\n          });\n        }\n      }\n    }\n  }\n\n  postprocess(modelStructure, allEntities);\n  return modelStructure;\n}\n\n\nconst Natural = {\n  _find: find,\n  _findAll: findAll,\n  _findIfPropertyIsRequired: findIfPropertyIsRequired,\n  _findIfPropertyHasMultiple: findIfPropertyHasMultiple,\n  _filterTree: filterTree,\n  seperateSentences,\n  generateModelStructure,\n  parse,\n};\n\nexport default Natural;\n\n\n\n// WEBPACK FOOTER //\n// ./src/services/natural.js","import Natural from '../services/natural';\n\nexport function parseSpreadsheet(spreadsheets) {\n  // Assume spreadsheet is array of csv's\n\n  const allModelDefinitions = [];\n\n  for (const csv of spreadsheets) {\n    let modelDefinition = {};\n    let [headingLine, ...rowLines] = csv.split('\\n');\n    let headings = headingLine.split(',');\n    let rows = rowLines.map(r => r.split(','));\n\n\n    for (let i = 0; i < headings.length; i++) {\n      let name = headings[i];\n\n      let types = new Set(rows.map(row => determineType(row[i])));\n      console.log({name, types});\n    }\n\n    allModelDefinitions.push(modelDefinition);\n  }\n}\n\nfunction mode(array) {\n  if (!array || array.length === 0) return null;\n  return array.reduce(array[0], (prev, value) => {\n    return (value > prev) ? value : prev;\n  });\n}\n\n// Given a array of type information, determines the type which encompases all values\nexport function determineType(information) {\n  let type;\n  let multiple = false;\n  let required = true;\n\n  for (const value of information) {\n    if (value === null || value === undefined) {\n      required = false;\n      continue;\n    }\n\n    if (value.type === 'string') {\n      type = 'string';\n    } else if (value.type === 'float') {\n      if (type !== 'string') {\n        type = 'float';\n      }\n    } else if (value.type === 'integer') {\n      if (type !== 'float' || type !== 'string') {\n        type = 'integer';\n      }\n    }\n\n    if (value.multiple = true) {\n      multiple = true;\n    }\n  }\n\n  return {\n    type,\n    multiple,\n    required,\n  };\n}\n\n// Given a string, finds the most likely type\nexport function findType(string) {\n  // If there is no value assume null\n  if ((string === null) || (string === undefined)) return null;\n\n  let object = safeJSONParse(string);\n  let multiple = Array.isArray(object);\n  let type;\n\n  if (multiple) {\n    type = 'string';\n    type = determineType(object.map(findType)).type;\n    console.log(type);\n    if (type.multiple) {\n      throw new Error('Multidimensional arrays are not supported!');\n    }\n  } else {\n    // Check for floats\n    if (/^\\-?((\\d+\\.\\d*)|(\\d+\\.\\d*))$/.test(string)) {\n      type = 'float';\n    } else if (/^\\-?(\\d+)$/.test(string)) {\n      type = 'integer';\n    } else {\n      type = 'string';\n    }\n  }\n\n  return {\n    type,\n    multiple,\n    example: string,\n  }\n\n}\n\nfunction safeJSONParse(string) {\n  try {\n    return JSON.parse(string);\n  } catch (e) {\n    return null;\n  }\n}\n\nexport function parseNaturalLanguage(text) {\n  return Natural.generateModelStructure(text);\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/services/parse.js","import databaseModels from '../models';\n\nconst { Service, Model, Attribute, Entry, Value } = databaseModels;\n\nexport async function createService(name, modelDefinitions, userId) {\n  let service = await Service.create({\n    name,\n    isPublic: false,\n    UserId: userId,\n  });\n\n  service = service.toJSON();\n\n  const models = [];\n\n  for (const modelDefinition of modelDefinitions) {\n    const model = await Model.create({\n      name: modelDefinition.name,\n      ServiceId: service.id,\n    });\n\n    const modelJSON = model.toJSON();\n    const attributes = [];\n    const attributeByName = {};\n\n    for (const attributeDefinition of modelDefinition.attributes) {\n      const attribute = await Attribute.create({\n        name: attributeDefinition.name,\n        type: attributeDefinition.type,\n        ModelId: model.id,\n      });\n\n      attributeByName[attributeDefinition.name] = attribute;\n      attributes.push(attribute.toJSON());\n    }\n\n    modelJSON.attributes = attributes;\n\n    const entries = [];\n\n    let index = 1;\n    for (const entriesDefinition of modelDefinition.entries) {\n      const entry = await Entry.create({\n        index,\n        ModelId: model.id,\n      });\n      index++;\n\n      const entryJSON = entry.toJSON();\n      const values = [];\n\n      for (const attributeString of Object.keys(entriesDefinition)) {\n        if (!attributeByName[attributeString]) {\n          throw new Error(`Please only specify attributes which are defined in the model (${attributeString}).`);\n        }\n        const value = await Value.create({\n          AttributeId: attributeByName[attributeString].id,\n          value: entriesDefinition[attributeString],\n          EntryId: entry.id,\n        });\n\n        values.push(value.toJSON());\n      }\n\n      entryJSON.values = values;\n      entries.push(entryJSON);\n    }\n\n    modelJSON.entries = entries;\n    models.push(modelJSON);\n  }\n\n  service.models = models;\n\n  return service;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/services/service.js","module.exports = require(\"bcrypt\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"bcrypt\"\n// module id = 27\n// module chunks = 0","module.exports = require(\"body-parser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"body-parser\"\n// module id = 28\n// module chunks = 0","module.exports = require(\"fs\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"fs\"\n// module id = 29\n// module chunks = 0","module.exports = require(\"nlp_compromise\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"nlp_compromise\"\n// module id = 30\n// module chunks = 0","module.exports = require(\"passport\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"passport\"\n// module id = 31\n// module chunks = 0","module.exports = require(\"passport-local\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"passport-local\"\n// module id = 32\n// module chunks = 0","module.exports = require(\"path\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"path\"\n// module id = 33\n// module chunks = 0","module.exports = require(\"request-promise\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"request-promise\"\n// module id = 34\n// module chunks = 0","module.exports = require(\"sbd\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"sbd\"\n// module id = 35\n// module chunks = 0","module.exports = require(\"sequelize\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"sequelize\"\n// module id = 36\n// module chunks = 0","module.exports = require(\"validator\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"validator\"\n// module id = 37\n// module chunks = 0"],"sourceRoot":""}