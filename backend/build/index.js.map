{"version":3,"sources":["webpack:///webpack/bootstrap 9880d82b8eb9ae1ee397","webpack:///./src/models/index.js","webpack:///external \"express\"","webpack:///./src/components/utils.js","webpack:///external \"underscore\"","webpack:///./src/config/passport.js","webpack:///external \"jsonwebtoken\"","webpack:///./src/index.js","webpack:///./src/components/natural.js","webpack:///./src/components/parse.js","webpack:///./src/components/service.js","webpack:///./src/config/bootstrap.js","webpack:///./src/config/connections.js","webpack:///./src/middleware/authentication.js","webpack:///./src/models/attribute.js","webpack:///./src/models/entry.js","webpack:///./src/models/model.js","webpack:///./src/models/service.js","webpack:///./src/models/user.js","webpack:///./src/models/value.js","webpack:///./src/routes/api.js","webpack:///./src/routes/attribute.js","webpack:///./src/routes/auth.js","webpack:///./src/routes/entry.js","webpack:///./src/routes/index.js","webpack:///./src/routes/model.js","webpack:///./src/routes/service.js","webpack:///./src/routes/value.js","webpack:///external \"bcrypt\"","webpack:///external \"body-parser\"","webpack:///external \"fs\"","webpack:///external \"multer\"","webpack:///external \"nlp_compromise\"","webpack:///external \"passport\"","webpack:///external \"passport-local\"","webpack:///external \"path\"","webpack:///external \"request-promise\"","webpack:///external \"sbd\"","webpack:///external \"sequelize\"","webpack:///external \"xlsx\""],"names":["basename","path","__filename","env","process","NODE_ENV","db","config","connections","sequelize","use_env_variable","database","username","password","models","attribute","entry","model","service","user","value","capitalizeString","str","charAt","toUpperCase","slice","modelName","hasOwnProperty","Object","keys","forEach","associate","Sequelize","stringToShortName","string","toLowerCase","replace","encode","type","decode","parseInt","parseFloat","User","passport","use","usernameField","passwordField","session","passReqToCallback","req","done","findOne","where","then","foundUser","validPassword","message","create","passwordHash","generateHash","payload","id","token","jwt","sign","catch","err","serializeUser","deserializeUser","find","bootstrap","app","Express","port","sync","bodyParser","json","initialize","res","next","Error","status","locals","error","get","render","listen","console","log","text","parseResult","parse","modelStructure","allEntities","sentenceResult","data","potentialRelationships","parse_list","filter","word","POS_fine","startsWith","tokens","cleanTree","filterTree","parse_tree","m","treeIndex","cleanTreeIndex","obj","relationship","inTree","nounTree","compareDepth","a","b","depth","length","subject","o","arc","includes","sort","object","attributes","fullObject","getConjuctions","map","assignNounPhrase","entities","fullSubject","attributesWithTypes","property","push","categoriseProp","entity","existingEntity","s","name","lemma","concat","raw","postprocess","generateModelStructure","request","post","form","seperateSentences","join","JSON","condition","modifiers","child","result","findAll","found","decide","values","sum","Number","findIfPropertyIsRequired","prop","context","optionalKeywords","requiredKeywords","allRequiredInformation","monads","monad","k","findIfPropertyHasMultiple","determiners","adjModifiers","numModifiers","combined","allCardinalityInfo","modifier","singleKeywords","multipleKeywords","compromise","number","isContainment","containmentWords","w","buildPhrase","tree","transform","space","othersInPhrase","start","propertyName","multiple","correctedNoun","noun","pluralize","singularize","presentVerb","verb","to_present","capitalizeWord","propertyType","propWords","split","integerKeywords","floatKeywords","intersection","required","followModifiers","deeperConjuctions","flatMap","array","lambda","Array","prototype","apply","flatten","stringify","e","assign","undefined","p","preps","prepPhrases","tags","more","Natural","_find","_findAll","_findIfPropertyIsRequired","_findIfPropertyHasMultiple","_filterTree","parseSpreadsheet","file","workbook","XLSX","readFile","sheetNames","SheetNames","csvs","Sheets","sheet","utils","sheet_to_csv","sheetByName","allModelDefinitions","csv","modelDefinition","headingLine","rowLines","headings","rows","r","trim","entries","i","headingName","types","determineType","Set","row","findType","Promise","resolve","information","safeJSONParse","isArray","test","example","parseNaturalLanguage","Service","Model","Attribute","Entry","Value","modelDefinitions","userId","isPublic","shortName","UserId","toJSON","bulkCreate","def","ServiceId","attributesToCreate","entriesToCreate","entryByIndexByModel","attributeDefinition","ModelId","entryByIndex","index","entriesDefinition","include","all","nested","valuesToCreate","Entries","Attributes","entryDefinition","AttributeId","EntryId","createService","development","host","dialect","production","originalUrl","headers","authorization","end","verify","decoded","findById","DataTypes","define","STRING","BOOLEAN","classMethods","belongsTo","onDelete","foreignKey","allowNull","INTEGER","hasMany","isFindEnabled","defaultValue","isFindOneEnabled","isCreateEnabled","isUpdateEnabled","isDeleteEnabled","unique","bcrypt","hashSync","genSaltSync","instanceMethods","compare","router","Router","param","serviceShortName","modelShortName","method","input","body","send","success","forbiddenResponse","valueByAttributeId","v","objects","localValues","newestEntry","order","valuePromises","newValue","oldValue","update","destroy","Boolean","modelId","newEntries","response","patch","attributeId","toUpdate","delete","validate","errors","validation","authenticate","users","serviceId","upload","multer","dest","single","services","entryId","foundValue","findOrCreate"],"mappings":"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","file":"index.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 39);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 9880d82b8eb9ae1ee397","import fs from 'fs';\nimport path from 'path';\nimport Sequelize from 'sequelize';\nimport connections from '../config/connections';\n\nconst basename = path.basename(__filename);\nconst env = process.env.NODE_ENV || 'development';\nconst db = {};\n\nconst config = connections[env];\n\nlet sequelize;\nif (config.use_env_variable) {\n  sequelize = new Sequelize(process.env[config.use_env_variable]);\n} else {\n  sequelize = new Sequelize(config.database, config.username, config.password, config);\n}\n\nimport attribute from './attribute';\nimport entry from './entry';\nimport model from './model';\nimport service from './service';\nimport user from './user';\nimport value from './value';\n\nconst models = {\n  attribute,\n  entry,\n  model,\n  service,\n  user,\n  value,\n};\n\nconst capitalizeString = str => str.charAt(0).toUpperCase() + str.slice(1);\n\nfor (const modelName in models) {\n  if (!models.hasOwnProperty(modelName)) continue;\n\n  db[capitalizeString(modelName)] = models[modelName](sequelize, Sequelize);\n}\n\nObject.keys(db).forEach((modelName) => {\n  if (db[modelName].associate) {\n    db[modelName].associate(db);\n  }\n});\n\ndb.sequelize = sequelize;\ndb.Sequelize = Sequelize;\n\nexport default db;\n\n\n\n// WEBPACK FOOTER //\n// ./src/models/index.js","module.exports = require(\"express\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express\"\n// module id = 1\n// module chunks = 0","\n\nexport function stringToShortName(string) {\n  return string.toLowerCase().replace(/\\W/g, '');\n}\n\nexport function encode(value, type) {\n  return `${value}`;\n}\n\nexport function decode(string, type) {\n  switch (type) {\n    case 'integer':\n      return parseInt(string, 10);\n    case 'float':\n      return parseFloat(string);\n    default:\n      return string;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/utils.js","module.exports = require(\"underscore\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"underscore\"\n// module id = 3\n// module chunks = 0","import passport from 'passport';\nimport { Strategy as LocalStrategy } from 'passport-local';\nimport models from '../models';\nimport jwt from 'jsonwebtoken';\n\nconst { User } = models;\n\npassport.use(new LocalStrategy({\n  usernameField: 'username',\n  passwordField: 'password',\n  session: false,\n  passReqToCallback: true,\n}, (req, username, password, done) => User.findOne({\n  where: {\n    username,\n  },\n})\n    .then(async (foundUser) => {\n      let user;\n      if (foundUser) {\n        // User exists\n        if (!(await foundUser.validPassword(password))) {\n          return done(null, false, {\n            message: 'Incorrect password.',\n          });\n        }\n        user = foundUser;\n      } else {\n        // New user\n        user = await User.create({\n          username,\n          passwordHash: User.generateHash(password),\n        });\n      }\n\n      const payload = {\n        user: user.id,\n      };\n\n      const token = jwt.sign(payload, 'secret');\n\n      return done(null, {\n        user: {\n          username: user.username,\n        },\n        token,\n      });\n    })\n    .catch(err => done(err)),\n));\n\npassport.serializeUser((user, done) => {\n  done(null, user.id);\n});\n\npassport.deserializeUser((id, done) => {\n  User.find({\n    where: { id },\n  }, (err, [user]) => {\n    done(err, user);\n  });\n});\n\nexport default passport;\n\n\n\n// WEBPACK FOOTER //\n// ./src/config/passport.js","module.exports = require(\"jsonwebtoken\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"jsonwebtoken\"\n// module id = 5\n// module chunks = 0","import Express from 'express';\nimport bodyParser from 'body-parser';\nimport passport from './config/passport';\nimport index from './routes/index';\nimport auth from './routes/auth';\nimport service from './routes/service';\nimport model from './routes/model';\nimport entry from './routes/entry';\nimport attribute from './routes/attribute';\nimport value from './routes/value';\nimport api from './routes/api';\nimport bootstrap from './config/bootstrap';\nimport models from './models';\nimport authentication from './middleware/authentication';\n\n\nbootstrap().then(async () => {\n  /* eslint-disable new-cap */\n  const app = Express();\n  const port = 9001;\n\n  await models.sequelize.sync();\n\n  app.use(bodyParser.json());\n\n  app.use(passport.initialize());\n  app.use(authentication);\n\n  app.use('/api', index);\n  app.use('/api/service', service);\n  app.use('/api/auth', auth);\n  app.use('/api/model', model);\n  app.use('/api/attribute', attribute);\n  app.use('/api/entry', entry);\n  app.use('/api/value', value);\n  app.use('/api/api/', api);\n\n  // catch 404 and forward to error handler\n  app.use((req, res, next) => {\n    const err = new Error('Not Found!');\n    err.status = 404;\n    next(err);\n  });\n\n  // error handler\n  app.use((err, req, res) => {\n    // set locals, only providing error in development\n    /* eslint-disable no-param-reassign */\n    res.locals.message = err.message;\n    res.locals.error = req.app.get('env') === 'development' ? err : {};\n\n    // render the error page\n    res.status(err.status || 500);\n    res.render('error');\n  });\n\n  app.listen(port);\n  console.log(`Server is running on port ${port}`);\n})\n.catch(err => console.error(err));\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","import { intersection } from 'underscore';\nimport request from 'request-promise';\nimport compromise from 'nlp_compromise';\n\n/**\n * Natural Service: A service for extracting information from natural speech.\n */\nimport { sentences as seperateSentences } from 'sbd';\n\n// Uses spacy to deconstruct text into a dependancy parse tree\nfunction parse(text) {\n  return request.post('http://localhost:5000/parse', {\n    form: {\n      text: seperateSentences(text).join('<#SENT_SEPERATOR#>'),\n    },\n  })\n  .then(res => JSON.parse(res));\n}\n\n// In the dependency parse tree it finds first object which satisfies the condition\nfunction find(object, condition) {\n  if (condition(object)) return object;\n\n  if (!object || !object.modifiers || object.modifiers.length === 0) return null;\n  for (const child of object.modifiers) {\n    const result = find(child, condition);\n    if (result) return result;\n  }\n  return null;\n}\n\n// In the dependency parse tree it finds all objects which satisfy the condition\nfunction findAll(object, condition) {\n  let found = [];\n  if (condition(object)) found.push(object);\n\n  if (!object || !object.modifiers || object.modifiers.length === 0) return found;\n\n  for (const child of object.modifiers) {\n    const result = findAll(child, condition);\n    if (result.length) found = [...result, ...found];\n  }\n  return found;\n}\n\n// From an array of booleans decide the final value\nfunction decide(values) {\n  if (values.length === 0) return null;\n\n  let sum = 0;\n  for (const value of values) {\n    sum += Number(value);\n  }\n  return sum / values.length >= 0.5;\n}\n\n// Finds the existance of property. Returns string of 'required', 'optional', 'unknown'\nfunction findIfPropertyIsRequired(prop, context) {\n  //  https://en.wikipedia.org/wiki/Auxiliary_verb\n  const optionalKeywords = ['may', 'might', 'could', 'should', 'maybe', 'possible', 'possibly', 'optionally', 'optional', 'ought'];\n  const requiredKeywords = ['must', 'needs', 'need', 'shall', 'will'];\n\n  const allRequiredInformation = [];\n\n  // Find if the relationship has monads attached\n  if (!context.modifiers || !context.modifiers.length) return false;\n  const monads = context.modifiers.filter(o => o.arc === 'aux');\n\n  for (const monad of monads) {\n    if (optionalKeywords.find(k => k === monad.lemma)) {\n      allRequiredInformation.push(false);\n    } else if (requiredKeywords.find(k => k === monad.lemma)) {\n      allRequiredInformation.push(true);\n    }\n  }\n\n  return decide(allRequiredInformation) || false;\n}\n\n// Finds if a property has multiple instances\nfunction findIfPropertyHasMultiple(prop) {\n  const determiners = prop.modifiers ? prop.modifiers.filter(o => o.arc === 'det') : [];\n  const adjModifiers = prop.modifiers ? prop.modifiers.filter(o => o.arc === 'amod') : [];\n  const numModifiers = prop.modifiers ? prop.modifiers.filter(o => o.arc === 'nummod') : [];\n\n  const combined = determiners.concat(adjModifiers).concat(numModifiers);\n\n  // If the noun is plural then it will be multiple\n  if (prop.POS_fine === 'NNS') {\n    return true;\n  }\n\n  if (combined.length === 0) return false;\n\n  // Find all information related to upper bound\n  const allCardinalityInfo = [];\n  for (const modifier of combined) {\n    const singleKeywords = ['a', 'single', 'one'];\n    const multipleKeywords = ['many', 'multiple', 'several'];\n    // const singleNumbers = ['one', 'zero'];\n\n    if (modifier.arc === 'nummod') {\n      // Parse value of number\n      allCardinalityInfo.push(compromise.value(modifier.lemma).number > 1);\n    }\n\n    if (singleKeywords.find(k => k === modifier.lemma)) {\n      allCardinalityInfo.push(false);\n    } else if (multipleKeywords.find(k => k === modifier.lemma)) {\n      allCardinalityInfo.push(true);\n    }\n  }\n\n  return decide(allCardinalityInfo) || false;\n}\n\nfunction isContainment(relationship) {\n  const containmentWords = [\n    'have',\n    'include',\n    'incorporate',\n    'consist',\n    'comprise',\n    'contain',\n  ];\n\n  return containmentWords.find(w => w == relationship.lemma);\n}\n\nfunction buildPhrase(tree, transform = w => w, space = ' ') {\n  const othersInPhrase = tree.othersInPhrase;\n\n  if (othersInPhrase.length) {\n    return [tree, ...othersInPhrase].sort((a, b) => a.start - b.start).map(o => o.word).map(transform).join(space);\n  }\n  return tree.word;\n}\n\nfunction propertyName(prop, relationship, multiple) {\n  let entity = '';\n\n  const correctedNoun = multiple ?\n    compromise.noun(prop.lemma).pluralize() :\n    compromise.noun(prop.lemma).singularize();\n\n\n  const othersInPhrase = prop.othersInPhrase;\n\n  entity = buildPhrase(prop);\n\n  if (isContainment(relationship)) {\n    return entity;\n  }\n\n  const presentVerb = compromise.verb(relationship.word).to_present();\n\n  return `${presentVerb} ${entity}`;\n}\n\nconst capitalizeWord = str => str.charAt(0).toUpperCase() + str.slice(1);\n\nfunction propertyType(prop, entities = []) {\n  for (const entity of entities) {\n    if (entity.raw === prop.raw ||\n        entity.lemma === prop.lemma) {\n      return capitalizeWord(entity.lemma);\n    }\n  }\n\n  const propWords = prop.name.split(' ');\n\n  // Check criteria for number.\n  const integerKeywords = [\n    'number',\n    'integer',\n  ];\n\n  const floatKeywords = [\n    'float',\n    'double',\n  ];\n\n  if (intersection(propWords, integerKeywords).length > 0) {\n    return 'integer';\n  }\n\n  if (intersection(propWords, floatKeywords).length > 0) {\n    return 'float';\n  }\n\n  return 'string';\n}\n\nfunction categoriseProp(prop, context, relationship, entities) {\n  const multiple = findIfPropertyHasMultiple(prop);\n\n  const type = propertyType(prop, entities);\n  const name = propertyName(prop, relationship, multiple);\n  const required = findIfPropertyIsRequired(prop, context);\n\n  return {\n    type,\n    name,\n    raw: prop.word,\n    lemma: prop.lemma,\n    required,\n    multiple,\n  };\n}\n\nfunction getConjuctions(object) {\n  return followModifiers(object, o => o.arc === 'conj');\n}\n\nfunction followModifiers(tree, condition) {\n  if (!tree || !tree.modifiers || tree.modifiers.length === 0) return [];\n\n  const [modifier] = tree.modifiers.filter(condition);\n  const deeperConjuctions = followModifiers(modifier, condition);\n\n  if (deeperConjuctions.length) {\n    return [\n      modifier,\n      ...deeperConjuctions,\n    ];\n  }\n  if (modifier) {\n    return [modifier];\n  }\n  return [];\n}\n\nfunction postprocess(modelStructure, entities) {\n  for (const models of modelStructure) {\n    for (const prop of models.attributes) {\n      prop.type = propertyType(prop, entities);\n    }\n  }\n}\n\nfunction flatMap(array, lambda) {\n  if (!array) return [];\n  return Array.prototype.concat.apply([], array.map(lambda));\n}\n\nfunction flatten(array) {\n  if (!array) return [];\n  return Array.prototype.concat.apply([], array);\n}\n\nfunction filterTree(tree, condition, depth = 0) {\n  if (!tree) return;\n  if (depth === 0) tree = JSON.parse(JSON.stringify(tree)); // Clone the tree\n\n  const modifiers = flatMap(\n    tree.modifiers,\n    m => filterTree(m, e => condition(e, depth, tree), depth + 1),\n  );\n\n  if (condition(tree)) {\n    if (modifiers.length < 1) {\n      // delete tree.modifiers;\n      return Object.assign(tree, {\n        modifiers: undefined,\n      });\n    }\n    return Object.assign(tree, {\n      modifiers,\n    });\n  }\n  return modifiers;\n}\n\nfunction assignNounPhrase(p) {\n  const preps = findAll(p, o => o.arc === 'prep');\n  const prepPhrases = preps.map(\n    o => [o, ...(o.modifiers.filter(m => m.arc === 'pobj'))],\n  );\n\n  const tags = ['compound', 'amod'];\n  const more = findAll(p, m => tags.includes(m.arc));\n\n  p.othersInPhrase = [...flatten(prepPhrases), ...more].sort((a, b) => a.start - b.start);\n\n  return p;\n}\n\nasync function generateModelStructure(text) {\n  // Annotate raw text with POS and get dependency structure\n  const parseResult = await parse(text);\n  const modelStructure = [];\n  let allEntities = [];\n\n  // Useful transformations\n  // Remove oxford comma!\n\n  for (const sentenceResult of parseResult.data) {\n    // Find relationships\n    const potentialRelationships = sentenceResult.parse_list\n      .filter(word => word.POS_fine.startsWith('V'));\n\n    // Build up tree of words to their place in parse tree\n    const tokens = sentenceResult.parse_list;\n    const cleanTree = filterTree(sentenceResult.parse_tree[0], m => m.POS_fine.startsWith('V') || m.POS_fine.startsWith('N') || m.POS_fine === 'PRP');\n\n    const treeIndex = {};\n    const cleanTreeIndex = {};\n    tokens.forEach((token) => {\n      treeIndex[token.id] = find(sentenceResult.parse_tree[0], obj => obj.id === token.id);\n      cleanTreeIndex[token.id] = find(cleanTree, obj => obj.id === token.id);\n    });\n\n    for (const relationship of potentialRelationships) {\n      // First containment\n      let inTree = cleanTreeIndex[relationship.id];\n\n      const nounTree = filterTree(inTree, m => m.POS_fine.startsWith('N') || m.POS_fine === 'PRP');\n      const compareDepth = (a, b) => a.depth - b.depth;\n\n      if (!nounTree || nounTree.length < 1) continue;\n      // Find subject and object\n      const [subject] = nounTree.filter(o => o.arc.includes('subj')).sort(compareDepth);\n      const [object] = nounTree.filter(o => o.arc.includes('obj')).sort(compareDepth);\n\n      let attributes = [];\n      if (object) {\n        // This is the attributes\n        const fullObject = treeIndex[object.id];\n        attributes = [fullObject, ...getConjuctions(fullObject)];\n\n        attributes = attributes.map(assignNounPhrase);\n      }\n      let entities = [];\n      if (subject) {\n        // This is entities\n        const fullSubject = treeIndex[subject.id];\n        entities = [fullSubject, ...getConjuctions(fullSubject)];\n        allEntities = [...allEntities, ...entities];\n        allEntities = allEntities.map(assignNounPhrase);\n      }\n\n\n      inTree = treeIndex[relationship.id];\n\n      const attributesWithTypes = [];\n      for (const property of attributes) {\n        attributesWithTypes.push(categoriseProp(property, inTree, relationship, entities));\n      }\n\n      for (const entity of entities) {\n        const existingEntity = modelStructure.find(s => s.name === entity.lemma);\n\n        if (existingEntity) {\n          existingEntity.attributes = existingEntity.attributes.concat(attributesWithTypes);\n        } else {\n          modelStructure.push({\n            name: entity.lemma,\n            raw: entity.word,\n            attributes: attributesWithTypes,\n          });\n        }\n      }\n    }\n  }\n\n  postprocess(modelStructure, allEntities);\n  return modelStructure;\n}\n\n\nconst Natural = {\n  _find: find,\n  _findAll: findAll,\n  _findIfPropertyIsRequired: findIfPropertyIsRequired,\n  _findIfPropertyHasMultiple: findIfPropertyHasMultiple,\n  _filterTree: filterTree,\n  seperateSentences,\n  generateModelStructure,\n  parse,\n};\n\nexport default Natural;\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/natural.js","import XLSX from 'xlsx';\nimport Natural from '../components/natural';\nimport { object } from 'underscore';\n\nexport function parseSpreadsheet(file) {\n  // Assume spreadsheet is array of csv's\n  const workbook = XLSX.readFile(file.path);\n\n  const sheetNames = workbook.SheetNames;\n\n  const csvs = sheetNames\n    .map(name => workbook.Sheets[name])\n    .map(sheet => XLSX.utils.sheet_to_csv(sheet));\n\n  const sheetByName = object(sheetNames, csvs);\n\n  const allModelDefinitions = [];\n\n  for (const name of sheetNames) {\n    const csv = sheetByName[name];\n    const modelDefinition = {};\n    const [headingLine, ...rowLines] = csv.split('\\n');\n    const headings = headingLine.split(',');\n    const rows = rowLines\n      .map(r => r.split(','))\n      .filter(r => r.join('').trim().length > 0);\n\n    modelDefinition.name = name;\n\n    const attributes = [];\n    const entries = [];\n\n    for (let i = 0; i < headings.length; i++) {\n      const headingName = headings[i].toLowerCase();\n\n       // Get first 20 rows for sample data\n      const types = determineType(new Set(rows.slice(0, 20).map(row => findType(row[i]))));\n      attributes.push(Object.assign({ name: headingName }, types));\n    }\n\n    rows.forEach((row) => {\n      const entry = {};\n      attributes.forEach((attribute, i) => {\n        entry[attribute.name] = row[i];\n      });\n      entries.push(entry);\n    });\n\n    modelDefinition.entries = entries;\n    modelDefinition.attributes = attributes;\n    allModelDefinitions.push(modelDefinition);\n  }\n  return Promise.resolve(allModelDefinitions);\n}\n\n// Given a array of type information, determines the type which encompases all values\nexport function determineType(information) {\n  let type;\n  let multiple = false;\n  let required = true;\n\n  for (const value of information) {\n    if (value === null || value === undefined) {\n      required = false;\n      continue;\n    }\n\n    if (value.type === 'string') {\n      type = 'string';\n    } else if (value.type === 'float') {\n      if (type !== 'string') {\n        type = 'float';\n      }\n    } else if (value.type === 'integer') {\n      if (type !== 'float' && type !== 'string') {\n        type = 'integer';\n      }\n    }\n\n    if (value.multiple == true) {\n      multiple = true;\n    }\n  }\n\n  return {\n    type,\n    multiple,\n    required,\n  };\n}\n\n// Given a string, finds the most likely type\nexport function findType(raw) {\n  // If there is no value assume null\n  if ((raw === null) || (raw === undefined)) return null;\n\n  const string = raw.trim();\n  if (string.length === 0) return null;\n\n  const object = safeJSONParse(string);\n  const multiple = Array.isArray(object);\n  let type;\n\n  if (multiple) {\n    type = 'string';\n    type = determineType(object.map(findType)).type;\n\n    if (type.multiple) {\n      throw new Error('Multidimensional arrays are not supported!');\n    }\n  } else {\n    // Check for floats\n    if (/^-?((\\d+\\.\\d*)|(\\d+\\.\\d*))$/.test(string)) {\n      type = 'float';\n    } else if (/^-?(\\d+)$/.test(string)) {\n      type = 'integer';\n    } else {\n      type = 'string';\n    }\n  }\n\n  return {\n    type,\n    multiple,\n    example: string,\n  };\n}\n\nfunction safeJSONParse(string) {\n  try {\n    return JSON.parse(string);\n  } catch (e) {\n    return null;\n  }\n}\n\nexport function parseNaturalLanguage(text) {\n  return Natural.generateModelStructure(text);\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/parse.js","import databaseModels from '../models';\nimport { stringToShortName } from './utils';\n\nconst { Service, Model, Attribute, Entry, Value } = databaseModels;\n\n/* Model definition format\n\n{\n  name: string,\n  modelDefinitions: [\n    {\n      name: string,\n      attributes: [\n        {\n          name: string,\n          type: string,\n          required: boolean,\n          multiple: boolean,\n        }\n      ],\n      entries: [\n        {\n          [key]: value,\n        }\n      ]\n    }\n  ]\n}\n*/\n\nexport async function createService(name, modelDefinitions, userId) {\n  let service = await Service.create({\n    name,\n    isPublic: false,\n    shortName: stringToShortName(name),\n    UserId: userId,\n  });\n\n  service = service.toJSON();\n\n  await Model.bulkCreate(modelDefinitions.map(def => ({\n    name: def.name,\n    ServiceId: service.id,\n    shortName: stringToShortName(def.name),\n  })));\n\n  let models = await Model.findAll({\n    where: {\n      ServiceId: service.id,\n    },\n  });\n\n  const attributesToCreate = [];\n  const entriesToCreate = [];\n  const entryByIndexByModel = {};\n\n  let i = 0;\n  for (const modelDefinition of modelDefinitions) {\n    const model = models[i];\n    i++;\n    // Create attributes\n    for (const attributeDefinition of modelDefinition.attributes) {\n      attributesToCreate.push({\n        name: attributeDefinition.name,\n        type: attributeDefinition.type,\n        required: attributeDefinition.required,\n        multiple: attributeDefinition.multiple,\n        ModelId: model.id,\n      });\n    }\n\n    if (!modelDefinition.entries || modelDefinition.entries.length === 0) {\n      continue;\n    }\n\n    const entryByIndex = {};\n    // Create entries\n    let index = 1;\n    for (const entriesDefinition of modelDefinition.entries) {\n      entriesToCreate.push({\n        index,\n        ModelId: model.id,\n      });\n      entryByIndex[index] = entriesDefinition;\n      index++;\n    }\n    entryByIndexByModel[modelDefinition.name] = entryByIndex;\n  }\n\n  await Attribute.bulkCreate(attributesToCreate);\n  await Entry.bulkCreate(entriesToCreate);\n\n  models = await Model.findAll({\n    where: {\n      ServiceId: service.id,\n    },\n    include: [{ all: true, nested: true }],\n  });\n\n  const valuesToCreate = [];\n\n  // Index: model > entry > attribute > value\n  for (const model of models) {\n    for (const entry of model.Entries) {\n      for (const attribute of model.Attributes) {\n        const entryDefinition = entryByIndexByModel[model.name][entry.index];\n        valuesToCreate.push({\n          AttributeId: attribute.id,\n          EntryId: entry.id,\n          value: entryDefinition && entryDefinition[attribute.name],\n        });\n      }\n    }\n  }\n\n  await Value.bulkCreate(valuesToCreate);\n\n  service = await Service.findOne({\n    where: {\n      id: service.id,\n    },\n    include: [{ all: true, nested: true }],\n  });\n\n  return service;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/service.js","/**\n * Bootstrap: All scripts that should be executed before server starts running\n */\n\nexport default function bootstrap() {\n  return Promise.resolve();\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/config/bootstrap.js","const connections = {\n  development: {\n    username: 'martinkubat',\n    password: '',\n    database: 'martinkubat',\n    host: 'localhost',\n    dialect: 'postgres',\n  },\n  test: {\n    username: 'root',\n    password: null,\n    database: 'database_test',\n    host: '127.0.0.1',\n    dialect: 'mysql',\n  },\n  production: {\n    username: 'root',\n    password: null,\n    database: 'database_production',\n    host: '127.0.0.1',\n    dialect: 'mysql',\n  },\n};\n\nexport default connections;\n\n\n\n// WEBPACK FOOTER //\n// ./src/config/connections.js","import jwt from 'jsonwebtoken';\nimport models from '../models';\n\nconst { User } = models;\n\nexport default function (req, res, next) {\n  if (req.originalUrl.startsWith('/api/auth/login')) {\n    return next();\n  }\n\n  if (!req.headers.authorization) {\n    return res.status(401).end();\n  }\n\n  const token = req.headers.authorization.split(' ')[1];\n  return jwt.verify(token, 'secret', (err, decoded) => {\n    if (err) return res.status(401).end();\n\n    const userId = decoded.user;\n\n    return User.findById(userId)\n      .then((user) => {\n        if (user) {\n          req.user = user;\n          return next();\n        }\n        return res.status(401).end();\n      })\n      .catch(err => res.status(401).end());\n  });\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/middleware/authentication.js","export default function (sequelize, DataTypes) {\n  const Attribute = sequelize.define('Attribute', {\n    name: DataTypes.STRING,\n    type: DataTypes.STRING,\n    multiple: DataTypes.BOOLEAN,\n    required: DataTypes.BOOLEAN,\n  }, {\n    classMethods: {\n      associate(models) {\n        Attribute.belongsTo(models.Model, {\n          onDelete: 'CASCADE',\n          foreignKey: {\n            allowNull: false,\n          },\n        });\n      },\n    },\n  });\n\n  return Attribute;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/models/attribute.js","export default function (sequelize, DataTypes) {\n  const Entry = sequelize.define('Entry', {\n    index: DataTypes.INTEGER,\n  }, {\n    classMethods: {\n      associate(models) {\n        Entry.belongsTo(models.Model, {\n          onDelete: 'CASCADE',\n          foreignKey: {\n            allowNull: false,\n          },\n        });\n        Entry.hasMany(models.Value);\n      },\n    },\n  });\n\n  return Entry;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/models/entry.js","export default function (sequelize, DataTypes) {\n  const Model = sequelize.define('Model', {\n    name: DataTypes.STRING,\n    shortName: DataTypes.STRING,\n    isFindEnabled: {\n      type: DataTypes.BOOLEAN,\n      defaultValue: false,\n    },\n    isFindOneEnabled: {\n      type: DataTypes.BOOLEAN,\n      defaultValue: false,\n    },\n    isCreateEnabled: {\n      type: DataTypes.BOOLEAN,\n      defaultValue: false,\n    },\n    isUpdateEnabled: {\n      type: DataTypes.BOOLEAN,\n      defaultValue: false,\n    },\n    isDeleteEnabled: {\n      type: DataTypes.BOOLEAN,\n      defaultValue: false,\n    },\n  }, {\n    classMethods: {\n      associate(models) {\n        Model.belongsTo(models.Service, {\n          onDelete: 'CASCADE',\n          foreignKey: {\n            allowNull: false,\n          },\n        });\n        Model.hasMany(models.Attribute);\n        Model.hasMany(models.Entry);\n      },\n    },\n  });\n\n  return Model;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/models/model.js","export default function (sequelize, DataTypes) {\n  const Service = sequelize.define('Service', {\n    name: DataTypes.STRING,\n    shortName: DataTypes.STRING,\n    isPublic: DataTypes.BOOLEAN,\n  }, {\n    classMethods: {\n      associate(models) {\n        Service.belongsTo(models.User, {\n          onDelete: 'CASCADE',\n          foreignKey: {\n            allowNull: false,\n          },\n        });\n        Service.hasMany(models.Model);\n      },\n    },\n  });\n\n  return Service;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/models/service.js","import bcrypt from 'bcrypt';\n\nexport default function (sequelize, DataTypes) {\n  const User = sequelize.define('User', {\n    username: {\n      type: DataTypes.STRING,\n      unique: true,\n    },\n    passwordHash: DataTypes.STRING,\n  }, {\n    classMethods: {\n      associate(models) {\n        User.hasMany(models.Service);\n      },\n      generateHash: password => bcrypt.hashSync(password, bcrypt.genSaltSync(8), null),\n    },\n    instanceMethods: {\n      generateHash: password => bcrypt.hashSync(password, bcrypt.genSaltSync(8), null),\n      validPassword(password) {\n        return bcrypt.compare(password, this.passwordHash);\n      },\n    },\n  });\n\n  return User;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/models/user.js","export default function (sequelize, DataTypes) {\n  const Value = sequelize.define('Value', {\n    value: DataTypes.STRING,\n  }, {\n    classMethods: {\n      associate(models) {\n        Value.belongsTo(models.Entry, {\n          onDelete: 'CASCADE',\n          foreignKey: {\n            allowNull: false,\n          },\n        });\n        Value.belongsTo(models.Attribute);\n      },\n    },\n  });\n\n  return Value;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/models/value.js","import { Router } from 'express';\nimport { object } from 'underscore';\nimport databaseModels from '../models';\nimport { decode } from '../components/utils';\n\nconst { Service, Model, Attribute, Entry, Value, User } = databaseModels;\n\n\n/* eslint-disable new-cap */\nconst router = Router();\n\nrouter.all('/:user/:service/:model/:id?', async (req, res) => {\n  const username = req.param('user');\n  const serviceShortName = req.param('service');\n  const modelShortName = req.param('model');\n  const id = req.param('id');\n  const method = req.method;\n  const input = req.body;\n\n  let data;\n\n  try {\n    const user = await User.findOne({\n      where: {\n        username,\n      },\n    });\n\n    const service = await Service.findOne({\n      where: {\n        shortName: serviceShortName,\n        UserId: user.id,\n      },\n    });\n\n    console.log(service);\n\n    if (!service) {\n      return res.status(404).send({ success: false, message: `This service (${modelShortName}) was not found!` });\n    }\n\n    if (!service.isPublic) {\n      return res.status(403).send({ success: false, message: 'This service is not public!' });\n    }\n\n    const model = await Model.findOne({\n      where: {\n        shortName: modelShortName,\n        ServiceId: service.id,\n      },\n    });\n\n    if (!model) {\n      return res.status(404).send({ success: false, message: `This model (${modelShortName}) was not found!` });\n    }\n\n    const attributes = await Attribute.findAll({\n      where: {\n        ModelId: model.id,\n      },\n    });\n\n    data = { user, service, model };\n\n    const forbiddenResponse = { success: false, message: 'This action is not public!' };\n\n    switch (method) {\n      case 'GET': {\n        if (id) {\n          // Find One\n          if (!model.isFindOneEnabled) {\n            return res.status(403).send(forbiddenResponse);\n          }\n\n          const entry = await Entry.findOne({\n            where: {\n              index: id,\n              ModelId: model.id,\n            },\n          });\n\n          if (!entry) {\n            return res.status(404).send({ success: false, message: 'This resource doesn\\'t exist!' });\n          }\n\n          const values = await Value.findAll({\n            where: {\n              EntryId: entry.id,\n            },\n          });\n\n          const valueByAttributeId = object(\n            values.map(v => v.AttributeId), values.map(v => v.value),\n          );\n          const obj = {};\n          obj.id = entry.index;\n          for (const attribute of attributes) {\n            obj[attribute.name] = decode(valueByAttributeId[attribute.id], attribute.type);\n          }\n\n          data = obj;\n        } else {\n          // Find All\n          console.log(model);\n          if (!model.isFindEnabled) {\n            return res.status(403).send(forbiddenResponse);\n          }\n\n          const entries = await Entry.findAll({\n            where: {\n              ModelId: model.id,\n            },\n          });\n          const values = await Value.findAll({\n            where: {\n              EntryId: entries.map(a => a.id),\n            },\n          });\n          data = { values, attributes, entries };\n\n          const objects = [];\n          for (const entry of entries) {\n            const obj = {};\n\n            const localValues = values.filter(v => v.EntryId === entry.id);\n            const valueByAttributeId = object(\n              localValues.map(v => v.AttributeId), localValues.map(v => v.value),\n            );\n            obj.id = entry.index;\n            for (const attribute of attributes) {\n              obj[attribute.name] = decode(valueByAttributeId[attribute.id], attribute.type);\n            }\n\n            objects.push(obj);\n          }\n\n          data = objects;\n        }\n        break;\n      }\n      case 'POST': {\n        // Create\n        if (!model.isCreateEnabled) {\n          return res.status(403).send(forbiddenResponse);\n        }\n        const newestEntry = await Entry.findOne({\n          where: {\n            ModelId: model.id,\n          },\n          order: 'index DESC',\n        });\n\n        const index = (newestEntry ? newestEntry.index : 0) + 1;\n\n        const entry = await Entry.create({\n          index,\n          ModelId: model.id,\n        });\n\n        const obj = {};\n        obj.id = entry.index;\n\n        const valuePromises = [];\n        for (const attribute of attributes) {\n          valuePromises.push(\n            Value.create({\n              EntryId: entry.id,\n              AttributeId: attribute.id,\n              value: input[attribute.name],\n            }),\n          );\n          obj[attribute.name] = decode(input[attribute.name], attribute.type) || null;\n        }\n        await Promise.all(valuePromises);\n        data = obj;\n        break;\n      }\n      case 'PATCH': {\n        // Update\n        if (!model.isUpdateEnabled) {\n          return res.status(403).send(forbiddenResponse);\n        }\n\n        const entry = await Entry.findOne({\n          where: {\n            index: id,\n            ModelId: model.id,\n          },\n        });\n\n\n        if (!entry) {\n          return res.status(404).send({ success: false, message: 'This resource doesn\\'t exist!' });\n        }\n\n        const values = await Value.findAll({\n          where: {\n            EntryId: entry.id,\n          },\n        });\n\n        const valuePromises = [];\n        const valueByAttributeId = object(values.map(v => v.AttributeId), values.map(v => v));\n\n\n        const obj = {};\n        obj.id = entry.id;\n        for (const attribute of attributes) {\n          const newValue = input[attribute.name];\n          if (newValue) {\n            const oldValue = valueByAttributeId[attribute.id];\n            if (newValue !== oldValue.value) {\n              if (oldValue) {\n                // Update\n                valuePromises.push(\n                  Value.update(\n                    { value: newValue },\n                    { where: { id: oldValue.id } },\n                  ),\n                );\n              } else {\n                // Create\n                valuePromises.push(\n                  Value.create({\n                    EntryId: entry.id,\n                    AttributeId: attribute.id,\n                    value: newValue,\n                  }),\n                );\n              }\n            }\n            obj[attribute.name] = newValue;\n          } else {\n            obj[attribute.name] = valueByAttributeId[attribute.id].value;\n          }\n        }\n\n        await Promise.all(valuePromises);\n        data = obj;\n\n        break;\n      }\n      case 'DELETE': {\n        // Delete\n        if (!model.isDeleteEnabled) {\n          return res.status(403).send(forbiddenResponse);\n        }\n\n        const entry = await Entry.findOne({\n          where: {\n            index: id,\n            ModelId: model.id,\n          },\n        });\n\n\n        if (!entry) {\n          return res.status(404).send({ success: false, message: 'This resource doesn\\'t exist!' });\n        }\n\n        await Value.destroy({\n          where: {\n            EntryId: entry.id,\n          },\n        });\n\n        const result = await Entry.destroy({\n          where: {\n            index: id,\n            ModelId: model.id,\n          },\n        });\n        data = Boolean(result);\n\n        break;\n      }\n      default: {\n        return res.status(400).send({ success: false, message: 'This action is not supported by EasyAPI!' });\n      }\n    }\n  } catch (e) {\n    return res.status(500).send({ success: false, error: e });\n  }\n\n  res.send({ success: true, data });\n});\n\n\nexport default router;\n\n\n\n// WEBPACK FOOTER //\n// ./src/routes/api.js","import { Router } from 'express';\nimport databaseModels from '../models';\n\nconst { Service, Model, Attribute, Entry, Value } = databaseModels;\n\n/* eslint-disable new-cap */\nconst router = Router();\n\n/* POST scratch. */\nrouter.post('/', async (req, res) => {\n  const modelId = req.param('model');\n  const name = req.param('name');\n  const type = req.param('type');\n  const required = req.param('required');\n  const multiple = req.param('multiple');\n\n  try {\n    const attribute = await Attribute.create({\n      name,\n      type,\n      required,\n      multiple,\n      ModelId: modelId,\n    });\n\n    const entries = await Entry.findAll({\n      where: {\n        ModelId: modelId,\n      },\n    });\n\n    await Value.bulkCreate(entries.map(e => ({\n      EntryId: e.id,\n      AttributeId: attribute.id,\n    })));\n\n    const newEntries = await Entry.findAll({\n      where: {\n        ModelId: modelId,\n      },\n      include: [{ all: true }],\n    });\n\n    const response = {\n      attribute,\n      entries: newEntries,\n      success: true,\n    };\n    return res.json(response);\n  } catch (e) {\n    return res.status(501).json({\n      error: e,\n      success: false,\n    });\n  }\n});\n\nrouter.patch('/:id', async (req, res) => {\n  const attributeId = req.param('id');\n\n  const toUpdate = {};\n\n  if (req.param('name')) {\n    toUpdate.name = req.param('name');\n  }\n  if (req.param('type')) {\n    toUpdate.type = req.param('type');\n  }\n\n  try {\n    const attribute = await Attribute.update(\n      toUpdate,\n      { where: { id: attributeId } },\n    );\n\n    return res.json({\n      attribute,\n      success: true,\n    });\n  } catch (e) {\n    return res.status(501).json({\n      error: e,\n      success: false,\n    });\n  }\n});\n\nrouter.get('/', async (req, res) => {\n  try {\n    const modelId = req.param('model');\n    const attributes = await Attribute.findAll({\n      where: {\n        ModelId: modelId,\n      },\n      include: [{ all: true }],\n    });\n    return res.json({\n      attributes,\n      success: true,\n    });\n  } catch (e) {\n    return res.status(501).json({\n      error: e,\n      success: false,\n    });\n  }\n});\n\nrouter.delete('/', async (req, res) => {\n  try {\n    const id = req.param('id');\n    const result = await Attribute.destroy({\n      where: {\n        id,\n      },\n    });\n    return res.json({\n      result,\n      success: true,\n    });\n  } catch (e) {\n    return res.status(501).json({\n      error: e,\n      success: false,\n    });\n  }\n});\n\nexport default router;\n\n\n\n// WEBPACK FOOTER //\n// ./src/routes/attribute.js","import { Router } from 'express';\nimport passport from '../config/passport';\n\n/* eslint-disable new-cap */\nconst router = Router();\n\nfunction validate(form) {\n  const errors = {};\n  let success = true;\n\n  if (!form || !form.username || form.username.length < 5) {\n    success = false;\n    errors.username = 'This is not a valid username.';\n  }\n\n  if (!form || !form.password || form.password.length < 5) {\n    success = false;\n    errors.password = 'This password is too short.';\n  }\n\n  return {\n    success,\n    errors,\n  };\n}\n\n/* GET index. */\nrouter.post('/login', (req, res, next) => {\n  const validation = validate({\n    username: req.param('username'),\n    password: req.param('password'),\n  });\n\n  if (!validation.success) {\n    return res.status(400).json({\n      success: false,\n      errors: validation.errors,\n    });\n  }\n\n  return passport.authenticate('local', (err, user) => {\n    if (err || !user) {\n      return res.status(400).json({\n        success: false,\n        message: 'Incorrect details',\n      });\n    }\n\n    return res.status(200).json(Object.assign({\n      success: true,\n      errors: {},\n    }, user));\n  })(req, res, next);\n});\n\nrouter.post('/info', (req, res) => {\n  res.status(200).json(Object.assign({\n    success: true,\n    errors: {},\n    username: req.user.username,\n  }));\n});\n\n\nexport default router;\n\n\n\n// WEBPACK FOOTER //\n// ./src/routes/auth.js","import { Router } from 'express';\nimport databaseModels from '../models';\n\nconst { Service, Model, Attribute, Entry, Value } = databaseModels;\n\n/* eslint-disable new-cap */\nconst router = Router();\n\n/* POST scratch. */\nrouter.post('/', async (req, res) => {\n  const modelId = req.param('model');\n\n  try {\n    const newestEntry = await Entry.findOne({\n      where: {\n        ModelId: modelId,\n      },\n      order: 'index DESC',\n    });\n\n    const index = (newestEntry ? newestEntry.index : 0) + 1;\n\n    const attributes = await Attribute.findAll({\n      where: {\n        ModelId: modelId,\n      },\n    });\n\n    let entry = await Entry.create({\n      index,\n      ModelId: modelId,\n    });\n\n    const valuePromises = [];\n    for (const attribute of attributes) {\n      valuePromises.push(\n        Value.create({\n          EntryId: entry.id,\n          AttributeId: attribute.id,\n          value: '',\n        }),\n      );\n    }\n    await Promise.all(valuePromises);\n\n    entry = await Entry.findOne({\n      where: {\n        id: entry.id,\n      },\n      include: [{ all: true }],\n    });\n\n    const response = {\n      entry,\n      success: true,\n    };\n    return res.json(response);\n  } catch (e) {\n    return res.status(501).json({\n      error: e,\n      success: false,\n    });\n  }\n});\n\nrouter.get('/', async (req, res) => {\n  try {\n    const modelId = req.param('model');\n    const entries = await Entry.findAll({\n      where: {\n        ModelId: modelId,\n      },\n      include: [{ all: true }],\n    });\n    return res.json({\n      entries,\n      success: true,\n    });\n  } catch (e) {\n    return res.status(501).json({\n      error: e,\n      success: false,\n    });\n  }\n});\n\nrouter.delete('/', async (req, res) => {\n  try {\n    const id = req.param('id');\n\n    await Value.destroy({\n      where: {\n        EntryId: id,\n      },\n    });\n\n    await Entry.destroy({\n      where: {\n        id,\n      },\n    });\n\n    return res.json({\n      success: true,\n    });\n  } catch (e) {\n    return res.status(501).json({\n      error: e,\n      success: false,\n    });\n  }\n});\n\nexport default router;\n\n\n\n// WEBPACK FOOTER //\n// ./src/routes/entry.js","import { Router } from 'express';\nimport { User, Service } from '../models';\n\n/* eslint-disable new-cap */\nconst router = Router();\n\nrouter.get('/models', (req, res) => {\n  User.findAll({\n    include: [Service],\n  }).then((users) => {\n    res.send(users);\n  });\n});\n\nexport default router;\n\n\n\n// WEBPACK FOOTER //\n// ./src/routes/index.js","import { Router } from 'express';\nimport databaseModels from '../models';\nimport { stringToShortName } from '../components/utils';\n\nconst { Service, Model, Attribute, Entry, Value } = databaseModels;\n\n/* eslint-disable new-cap */\nconst router = Router();\n\n/* POST scratch. */\nrouter.post('/', async (req, res) => {\n  const serviceId = req.param('service');\n  const name = req.param('name');\n\n  try {\n    const model = await Model.create({\n      name,\n      shortName: stringToShortName(name),\n      ServiceId: serviceId,\n    });\n\n    const response = {\n      model,\n      success: true,\n    };\n    return res.json(response);\n  } catch (e) {\n    return res.status(501).json({\n      error: e,\n      success: false,\n    });\n  }\n});\n\nrouter.patch('/:id', async (req, res) => {\n  const modelId = req.param('id');\n\n  const toUpdate = {};\n\n  if (req.param('name')) {\n    toUpdate.name = req.param('name');\n    toUpdate.shortName = stringToShortName(toUpdate.name);\n  }\n\n  if (req.param('isFindEnabled')) {\n    toUpdate.isFindEnabled = req.param('isFindEnabled');\n  }\n\n  if (req.param('isFindOneEnabled')) {\n    toUpdate.isFindOneEnabled = req.param('isFindOneEnabled');\n  }\n\n  if (req.param('isCreateEnabled')) {\n    toUpdate.isCreateEnabled = req.param('isCreateEnabled');\n  }\n\n  if (req.param('isUpdateEnabled')) {\n    toUpdate.isUpdateEnabled = req.param('isUpdateEnabled');\n  }\n\n  if (req.param('isDeleteEnabled')) {\n    toUpdate.isDeleteEnabled = req.param('isDeleteEnabled');\n  }\n\n  try {\n    const model = await Model.update(\n      toUpdate,\n      { where: { id: modelId } },\n    );\n\n    return res.json({\n      model,\n      success: true,\n    });\n  } catch (e) {\n    return res.status(501).json({\n      error: e,\n      success: false,\n    });\n  }\n});\n\nrouter.get('/', async (req, res) => {\n  try {\n    const serviceId = req.param('service');\n    const model = await Model.findAll({\n      where: {\n        ServiceId: serviceId,\n      },\n      include: [{ all: true }],\n    });\n    return res.json({\n      model,\n      success: true,\n    });\n  } catch (e) {\n    return res.status(501).json({\n      error: e,\n      success: false,\n    });\n  }\n});\n\nrouter.delete('/', async (req, res) => {\n  try {\n    const id = req.param('id');\n    const result = await Model.destroy({\n      where: {\n        id,\n      },\n    });\n    return res.json({\n      result,\n      success: true,\n    });\n  } catch (e) {\n    return res.status(501).json({\n      error: e,\n      success: false,\n    });\n  }\n});\n\n\nexport default router;\n\n\n\n// WEBPACK FOOTER //\n// ./src/routes/model.js","import { Router } from 'express';\nimport multer from 'multer';\nimport { parseSpreadsheet, parseNaturalLanguage } from '../components/parse';\nimport { createService, findServices } from '../components/service';\nimport databaseModels from '../models';\n\nconst { Service, Model, Attribute, Entry, Value } = databaseModels;\n\nconst upload = multer({ dest: 'upload/' });\n\n/* eslint-disable new-cap */\nconst router = Router();\n\nrouter.post('/parseText', (req, res) => {\n  const text = req.param('text');\n  return parseNaturalLanguage(text)\n  .then(result => res.send(result));\n});\n\nrouter.post('/parseSpreadsheet', upload.single('spreadsheet'), (req, res) => parseSpreadsheet(req.file)\n  .then(result => res.send(result)));\n\n/* POST scratch. */\nrouter.post('/', async (req, res) => {\n  const name = req.param('name');\n  const modelDefinitions = req.param('models');\n\n  try {\n    const service = await createService(\n      name,\n      modelDefinitions,\n      req.user.id,\n    );\n\n    const response = {\n      service,\n      success: true,\n    };\n    return res.json(response);\n  } catch (e) {\n    return res.status(501).json({\n      error: e,\n      success: false,\n    });\n  }\n});\n\nrouter.get('/', async (req, res) => {\n  try {\n    const services = await Service.findAll({\n      where: {\n        UserId: req.user.id,\n      },\n      include: [{ all: true, nested: true }],\n    });\n    return res.json({\n      services,\n      success: true,\n    });\n  } catch (e) {\n    return res.status(501).json({\n      error: e,\n      success: false,\n    });\n  }\n});\n\n\nrouter.get('/:id', async (req, res) => {\n  try {\n    const serviceId = req.param('id');\n    const service = await Service.findOne({\n      where: {\n        id: serviceId,\n        UserId: req.user.id,\n      },\n      include: [{ all: true, nested: true }],\n    });\n    return res.json({\n      service,\n      success: true,\n    });\n  } catch (e) {\n    return res.status(501).json({\n      error: e,\n      success: false,\n    });\n  }\n});\n\nrouter.patch('/:id', async (req, res) => {\n  try {\n    const serviceId = req.param('id');\n    const toUpdate = {};\n\n    if (req.param('name')) {\n      toUpdate.name = req.param('name');\n    }\n    if (req.body.isPublic !== undefined) {\n      toUpdate.isPublic = req.body.isPublic;\n    }\n    if (req.param('shortName')) {\n      toUpdate.shortName = req.param('shortName');\n    }\n\n    const service = await Service.update(\n      toUpdate,\n      { where: { id: serviceId } },\n    );\n    return res.json({\n      service,\n      success: true,\n    });\n  } catch (e) {\n    return res.status(501).json({\n      error: e,\n      success: false,\n    });\n  }\n});\n\n\nexport default router;\n\n\n\n// WEBPACK FOOTER //\n// ./src/routes/service.js","import { Router } from 'express';\nimport databaseModels from '../models';\n\nconst { Service, Model, Attribute, Entry, Value } = databaseModels;\n\n/* eslint-disable new-cap */\nconst router = Router();\n\nrouter.patch('/', async (req, res) => {\n  const entryId = req.param('entry');\n  const attributeId = req.param('attribute');\n  const newValue = req.param('value');\n\n  try {\n    const [foundValue] = await Value.findOrCreate({\n      where: {\n        EntryId: entryId,\n        AttributeId: attributeId,\n      },\n      include: [{ all: true }],\n    });\n\n    // TODO Validate new value\n\n    const [value] = await Value.update(\n      { value: newValue },\n      { where: { id: foundValue.id } },\n    );\n\n    const response = {\n      value,\n      success: true,\n    };\n    return res.json(response);\n  } catch (e) {\n    return res.status(501).json({\n      error: e,\n      success: false,\n    });\n  }\n});\n\n\nexport default router;\n\n\n\n// WEBPACK FOOTER //\n// ./src/routes/value.js","module.exports = require(\"bcrypt\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"bcrypt\"\n// module id = 27\n// module chunks = 0","module.exports = require(\"body-parser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"body-parser\"\n// module id = 28\n// module chunks = 0","module.exports = require(\"fs\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"fs\"\n// module id = 29\n// module chunks = 0","module.exports = require(\"multer\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"multer\"\n// module id = 30\n// module chunks = 0","module.exports = require(\"nlp_compromise\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"nlp_compromise\"\n// module id = 31\n// module chunks = 0","module.exports = require(\"passport\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"passport\"\n// module id = 32\n// module chunks = 0","module.exports = require(\"passport-local\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"passport-local\"\n// module id = 33\n// module chunks = 0","module.exports = require(\"path\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"path\"\n// module id = 34\n// module chunks = 0","module.exports = require(\"request-promise\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"request-promise\"\n// module id = 35\n// module chunks = 0","module.exports = require(\"sbd\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"sbd\"\n// module id = 36\n// module chunks = 0","module.exports = require(\"sequelize\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"sequelize\"\n// module id = 37\n// module chunks = 0","module.exports = require(\"xlsx\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"xlsx\"\n// module id = 38\n// module chunks = 0"],"sourceRoot":""}